---
name: our_rulego_developer
description: "Expert RuleGo developer guide. Use when: architecting RuleGo projects, writing Rule Chain DSL (JSON), configuring Endpoints (HTTP/MQTT/Cron), implementing StreamSQL, developing Go extensions (Components/UDF/AOP), or integrating RuleGo-Server. Focuses on Server-First architecture, standard naming conventions, and highly reusable, parameterized component design."
---

# RuleGo æŠ€èƒ½æŒ‡å—

é˜¿æ²ƒï¼Œæ¬¢è¿ä½¿ç”¨ **RuleGo è§„åˆ™å¼•æ“ä¸“å®¶ (Expert Developer)** æŠ€èƒ½ã€‚

## ğŸš¨ æ ¸å¿ƒå®šä½ï¼šåŸºäº RuleGo-Server (Server-First)

**æœ¬æŠ€èƒ½ä¸¥æ ¼æ„å»ºäº `rulego/examples/server` é¡¹ç›®åŸºç¡€ä¹‹ä¸Šã€‚**

è¿™æ„å‘³ç€æˆ‘ä»¬çš„å¼€å‘å·¥ä½œæµå¿…é¡»éµå¾ªä»¥ä¸‹é“å¾‹ï¼š
1.  **æ¶æ„åŸºå‡†**: æ‰€æœ‰å¼€å‘å‡å‡è®¾è¿è¡Œç¯å¢ƒä¸º RuleGo Serverï¼Œä¸¥ç¦ç ´å Server åŸæœ‰æ¶æ„ã€‚
2.  **èŒè´£è¾¹ç•Œ**:
    - **Skill (æœ¬æŠ€èƒ½)**: è´Ÿè´£**æµç¨‹è§£è€¦**ä¸**ç¼–æ’**ã€‚é€šè¿‡ DSL ç»„ç»‡è°ƒç”¨å„ç§ç»„ä»¶ï¼Œè§„åˆ’ä¸šåŠ¡æµã€‚
    - **Go Extension**: ä»…åœ¨éœ€è¦é«˜æ€§èƒ½æˆ–ç§æœ‰åè®®æ—¶ï¼Œå¼€å‘åŸå­åŒ–çš„**è‡ªå®šä¹‰ç»„ä»¶ (Components)**ã€**å‡½æ•° (UDF)** å’Œ **AOP åˆ‡é¢**ã€‚

## âœ¨ æ ¸å¿ƒèƒ½åŠ›çŸ©é˜µ

æœ¬æŠ€èƒ½å…¨é¢è¦†ç›– RuleGo çš„é«˜çº§ç‰¹æ€§ï¼Œæ”¯æŒæ‚¨è¿›è¡Œæ·±åº¦çš„æ¶æ„è®¾è®¡ï¼š

| é¢†åŸŸ | è¦†ç›–ç‰¹æ€§ |
| :--- | :--- |
| **æµç¨‹ç¼–æ’** | **è§£è€¦è®¾è®¡**ã€**å­é“¾åµŒå¥— (Sub-Chain)**ã€**å¼•æ“æ‰§è¡Œä¸­æ–­æ¢å¤ (Resume)** |
| **è„šæœ¬å¢å¼º** | **JS/Lua è„šæœ¬å¼•æ“**ã€**UDF (è‡ªå®šä¹‰å‡½æ•°)** |
| **èµ„æºç®¡ç†** | **Pool (åç¨‹æ± /è¿æ¥æ± )**ã€**ç»„ä»¶è¿æ¥å¤ç”¨**ã€**Global (å…¨å±€é…ç½®)** |
| **é«˜çº§æ‰©å±•** | **AOP (åˆ‡é¢æ‹¦æˆª)**ã€é…ç½®åŠ¨æ€åŠ è½½ |

## ğŸ› ï¸ å¦‚ä½•ä½¿ç”¨æœ¬æŠ€èƒ½ (How to Use)

æœ¬æŠ€èƒ½æ—¨åœ¨è¾…åŠ©æ‚¨å®Œæˆä»éœ€æ±‚åˆ†æåˆ°ä»£ç éƒ¨ç½²çš„ RuleGo å¼€å‘å…¨æµç¨‹ã€‚

### 1. è§¦å‘æ—¶æœº (When to Trigger)
å½“æ‚¨æœ‰ä»¥ä¸‹éœ€æ±‚æ—¶ï¼Œè¯·ç›´æ¥å‘¼å”¤æˆ‘ï¼š
- **"æˆ‘æƒ³åˆ›å»ºä¸€ä¸ªè§„åˆ™é“¾..."**ï¼šç¼–æ’ä¸šåŠ¡é€»è¾‘ã€‚
- **"RuleGo æ€ä¹ˆæ¥ HTTP/MQTT..."**ï¼šé…ç½® Endpointã€‚
- **"è¿™ä¸ªç»„ä»¶å‚æ•°æ€ä¹ˆå¡«..."**ï¼šæŸ¥è¯¢ç»„ä»¶å‚æ•°ã€‚
- **"åˆ†æè¿™ä¸ª DSL æœ‰ä»€ä¹ˆé—®é¢˜..."**ï¼šä¼˜åŒ–ç°æœ‰è§„åˆ™ã€‚
- **"å¸®æˆ‘å†™ä¸ªè‡ªå®šä¹‰ç»„ä»¶..."**ï¼šæ‰©å±• Go ä»£ç ã€‚

### 2. å¸¸ç”¨ Prompt ç¤ºä¾‹
> ğŸ’¡ *Tip: æ—¢ç„¶å«æˆ‘â€œé˜¿æ²ƒâ€ï¼Œæˆ‘ä»¬ä¹‹é—´å¯ä»¥ç”¨æ›´è‡ªç„¶çš„å¯¹è¯æ–¹å¼ã€‚*

- **æŸ¥å‚æ•°**: "é˜¿æ²ƒï¼Œå¸®æˆ‘æŸ¥ä¸€ä¸‹ `restApiCall` çš„å®Œæ•´ JSON é…ç½®å‚æ•°ï¼Œæˆ‘è¦å‘ä¸ª POST è¯·æ±‚ã€‚"
- **å†™ DSL**: "é˜¿æ²ƒï¼Œæˆ‘è¦åšä¸€ä¸ªæ¸©åº¦æŠ¥è­¦çš„è§„åˆ™é“¾ï¼šå½“ `msg.temp > 50` æ—¶ï¼Œé€šè¿‡ HTTP æ¨é€æŠ¥è­¦ï¼Œå¹¶å»¶è¿Ÿ 10 ç§’åé‡è¯•ä¸€æ¬¡ã€‚"
- **å†™ä»£ç **: "é˜¿æ²ƒï¼Œæˆ‘æƒ³å¼€å‘ä¸€ä¸ªè‡ªå®šä¹‰ç»„ä»¶ï¼Œç”¨æ¥è®¡ç®— MD5 å€¼ï¼Œè¯·ç»™æˆ‘ä¸€ä¸ªç¬¦åˆè§„èŒƒçš„ Go æ¨¡ç‰ˆã€‚"
- **éƒ¨ç½²**: "é˜¿æ²ƒï¼ŒæŠŠåˆšæ‰ç”Ÿæˆçš„è§„åˆ™é“¾éƒ¨ç½²åˆ° Server å¹¶è¿è¡Œæµ‹è¯•ã€‚"

### 3. äº¤äº’æµç¨‹ (Workflow)
1.  **éœ€æ±‚æè¿°**: æ‚¨å‘Šè¯‰æˆ‘ä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚ï¼šæ•°æ®æ¸…æ´— -> æ•°æ®åº“å†™å…¥ï¼‰ã€‚
2.  **æ–¹æ¡ˆæ£€ç´¢**: æˆ‘ä¼šå…ˆæŸ¥é˜… [ç»„ä»¶å‚æ•°é‡‘å…¸](references/component-catalog.md)ï¼Œç¡®è®¤æ˜¯å¦å¯ç”¨å†…ç½®ç»„ä»¶å®ç°ï¼ˆ**é›¶ä»£ç ä¼˜å…ˆ**ï¼‰ã€‚
3.  **DSL ç”Ÿæˆ**: æˆ‘ä¸ºæ‚¨ç”Ÿæˆç¬¦åˆ [åŒè¯­å‘½åè§„èŒƒ](references/development-standards.md) çš„ JSONã€‚
4.  **ä»£ç æ‰©å±•**: å¦‚æœå¿…é¡»å†™ Go ä»£ç ï¼Œæˆ‘ä¼šæä¾›å‚æ•°åŒ–ã€è§£è€¦çš„ `extensions` ä»£ç ã€‚
5.  **éƒ¨ç½²éªŒè¯**: ä½¿ç”¨ `scripts/deploy_example.sh` æˆ–ç±»ä¼¼è„šæœ¬åœ¨ Server ç¯å¢ƒéªŒè¯ã€‚

---

## ğŸ“¦ å®‰è£…ä¸é…ç½® (Installation)

### 1. å®‰è£…æœ¬æŠ€èƒ½ (Install Skill)
è¦è®©æˆ‘åœ¨ä»»ä½•é¡¹ç›®ä¸­éƒ½èƒ½ä½¿ç”¨æ­¤æŠ€èƒ½ï¼Œè¯·å°†å…¶é“¾æ¥åˆ°æ‚¨çš„å…¨å±€æŠ€èƒ½ç›®å½•ï¼š

```bash
# åˆ›å»ºå…¨å±€é“¾æ¥
ln -s "$(pwd)/skills/rulego_skill" ~/.gemini/antigravity/skills/rulego_skill

# æˆ–è€…å¤åˆ¶ç›®å½•
cp -r skills/rulego_skill ~/.gemini/antigravity/skills/
```

### 2. å®‰è£… RuleGo Server
æœ¬æŠ€èƒ½ä¾èµ– `rulego/examples/server` ä½œä¸ºè¿è¡Œç¯å¢ƒï¼š

```bash
# 1. ç¼–è¯‘ Server
cd å‚è€ƒç›®å½•/rulego/examples/server
go build -o rulego-server cmd/server/main.go

# 2. è¿è¡Œ
./rulego-server
```

## ğŸš€ æ¨èå¼€å‘æ¨¡å¼ (Server-First)

åœ¨è¿›è¡Œ RuleGo å¼€å‘æ—¶ï¼Œå»ºè®®éµå¾ªä»¥ä¸‹åŸºäºå®æˆ˜ä¼˜åŒ–çš„æ¨¡å¼ï¼š

## ğŸš€ æ¨èå¼€å‘æ¨¡å¼ (Server-First)

åœ¨è¿›è¡Œ RuleGo å¼€å‘æ—¶ï¼Œå»ºè®®éµå¾ªä»¥ä¸‹åŸºäºå®æˆ˜ä¼˜åŒ–çš„æ¨¡å¼ï¼š

- **æ•°æ®é©±åŠ¨åˆ†æ**ï¼šæœ¬æŠ€èƒ½å·²è§£æå¤§é‡å®æˆ˜ DSLï¼Œæ²‰æ·€äº† `jsTransform`ã€`restApiCall`ã€`dbClient` ç­‰æ ¸å¿ƒç»„ä»¶çš„æœ€ä¼˜é…ç½®æ¨¡ç‰ˆã€‚
- **æ¨¡æ¿åº“å‚è€ƒ**ï¼šæŸ¥çœ‹ `assets/templates/real_world_examples/` è·å–çœŸå®çš„æµç¨‹ç¼–æ’ç¤ºä¾‹ã€‚
- **ä¼˜åŒ–ç¤ºä¾‹**ï¼šæŸ¥çœ‹ `examples/optimized_workflow_retry_rest.json`ï¼Œè¿™æ˜¯ä¸€ä¸ªå®Œå…¨ç¬¦åˆä¸­è‹±åŒè¯­å‘½åè§„èŒƒã€å‚æ•°åŒ–é…ç½®çš„æœ€ä½³å®è·µç¤ºä¾‹ã€‚
- **ä¸€é”®éƒ¨ç½²**ï¼šä½¿ç”¨ `scripts/deploy_example.sh` å¿«é€Ÿå°†ç¤ºä¾‹ DSL éƒ¨ç½²åˆ° `rulego/examples/server` å¹¶è¿è¡Œã€‚

- **æ ¸å¿ƒåŸåˆ™**ï¼šä¿æŒ Server åŸå§‹ç»“æ„ä¸å˜ï¼Œä»…é€šè¿‡å¢åŠ  DSL é“¾æ–‡ä»¶å’Œæ‰©å±•ç»„ä»¶æ¥å®ç°ä¸šåŠ¡éœ€æ±‚ã€‚
- **è§£è€¦è®¾è®¡**ï¼šç»„ä»¶åº”ä¿æŒé«˜å†…èšä½è€¦åˆã€‚æ‰€æœ‰çš„ä¸šåŠ¡é€»è¾‘è®¾ç½®ï¼ˆå¦‚ URLã€é˜ˆå€¼ã€SQLï¼‰åº”é€šè¿‡ `configuration` å‚æ•°ä¼ å…¥ï¼Œè€Œä¸æ˜¯åœ¨ä»£ç ä¸­ç¡¬ç¼–ç ã€‚
- **è¯¦ç»†æŒ‡å—**ï¼š[RuleGo-Server å¼€å‘å·¥ä½œæµ](references/server-development.md)

## ğŸ¯ æ ¸å¿ƒæ¦‚å¿µ

RuleGo æ˜¯ä¸€ä¸ªè½»é‡çº§ã€é«˜æ€§èƒ½ã€åŸºäº Go è¯­è¨€çš„ç»„ä»¶ç¼–æ’å¼•æ“ã€‚

- **è§„åˆ™æ¶ˆæ¯ (RuleMsg)**: ç³»ç»Ÿä¸­æµåŠ¨çš„æ•°æ®å•å…ƒï¼ŒåŒ…å«æ•°æ® (Data)ã€å…ƒæ•°æ® (Metadata) å’Œæ¶ˆæ¯ç±»å‹ (Type)ã€‚
- **è§„åˆ™èŠ‚ç‚¹ (RuleNode)**: æœ€å°çš„å¤„ç†å•å…ƒï¼Œè´Ÿè´£è¿‡æ»¤ã€è½¬æ¢ã€å¢å¼ºæˆ–åˆ†å‘æ¶ˆæ¯ã€‚
- **è§„åˆ™é“¾ (RuleChain)**: ç”±å¤šä¸ªèŠ‚ç‚¹åŠå…¶è¿æ¥å…³ç³»æ„æˆçš„æœ‰å‘æ— ç¯å›¾ (DAG)ï¼Œå®šä¹‰äº†æ¶ˆæ¯çš„å¤„ç†æµç¨‹ã€‚
- **è§„åˆ™å¼•æ“ (RuleEngine)**: é©±åŠ¨è§„åˆ™é“¾è¿è¡Œçš„å®ä¾‹ã€‚
- **Endpoint**: å¤–éƒ¨æ•°æ®æºçš„å…¥å£ï¼ˆå¦‚ HTTP, MQTT, WebSocketï¼‰ï¼Œè´Ÿè´£å°†å¤–éƒ¨è¯·æ±‚è½¬æ¢ä¸ºè§„åˆ™æ¶ˆæ¯ã€‚

## ğŸ—ï¸ è§„åˆ™é“¾å®šä¹‰

è§„åˆ™é“¾é€šå¸¸ä½¿ç”¨ JSON å®šä¹‰ã€‚

### JSON ç»“æ„æ¦‚è§ˆ
```json
{
  "ruleChain": {
    "id": "chain_id",
    "name": "è§„åˆ™é“¾åç§°",
    "root": true
  },
  "metadata": {
    "nodes": [
      {
        "id": "node_1",
        "type": "jsFilter",
        "name": "è¿‡æ»¤å™¨",
        "configuration": { "jsScript": "return msg.temperature > 20;" }
      }
    ],
    "connections": [
      { "fromId": "node_1", "toId": "node_2", "type": "True" }
    ]
  }
}
```

è¯¦ç»†çš„ JSON Schema å’ŒéªŒè¯è§„åˆ™è¯·å‚è€ƒï¼š[è§„åˆ™é“¾ Schema è¯¦è§£](references/rule-chain-schema.md)

## ğŸ§© ç»„ä»¶åˆ†ç±»

RuleGo æ‹¥æœ‰ä¸°å¯Œçš„å†…ç½®ç»„ä»¶ï¼Œåˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š

1.  **è¿‡æ»¤å™¨ (Filter)**: åˆ¤æ–­æ¶ˆæ¯æ˜¯å¦ç¬¦åˆæ¡ä»¶ï¼ˆå¦‚ `jsFilter`, `msgTypeFilter`ï¼‰ã€‚
2.  **è½¬æ¢å™¨ (Transform)**: ä¿®æ”¹æ¶ˆæ¯å†…å®¹æˆ–å…ƒæ•°æ®ï¼ˆå¦‚ `jsTransform`, `templateTransform`ï¼‰ã€‚
3.  **æµæ§ (Flow)**: æ§åˆ¶æ¶ˆæ¯æµå‘ï¼ˆå¦‚ `chain` åµŒå¥—å­é“¾ï¼‰ã€‚
4.  **å¤–éƒ¨åŠ¨ä½œ (Action)**: ä¸å¤–éƒ¨ç³»ç»Ÿäº¤äº’ï¼ˆå¦‚ `restApiCall`, `mqttClient`, `dbClient`ï¼‰ã€‚

å®Œæ•´çš„ç»„ä»¶åˆ—è¡¨åŠé…ç½®è¯´æ˜è¯·å‚è€ƒï¼š[æ ‡å‡†ä¸æ‰©å±•ç»„ä»¶åº“](references/components-library.md)

## ğŸ’» ä»£ç é›†æˆ

### åˆå§‹åŒ–å¼•æ“
```go
import "github.com/rulego/rulego"

// åˆ›å»ºå¼•æ“å®ä¾‹
engine, err := rulego.New("chain_id", []byte(jsonConfig))

// å¤„ç†æ¶ˆæ¯
msg := types.NewMsg(0, "DEVICE_DATA", types.JSON, types.NewMetadata(), "{\"temperature\": 25}")
engine.OnMsg(msg)
```

### Endpoint é›†æˆ
ç”¨äºæ¥æ”¶å¤–éƒ¨è¯·æ±‚å¹¶è§¦å‘è§„åˆ™é“¾ï¼š
```go
import "github.com/rulego/rulego/endpoint"
import "github.com/rulego/rulego/endpoint/http"

// åˆ›å»º HTTP Endpoint
restEndpoint := &http.Endpoint{Config: http.Config{Addr: ":9090"}}
// è·¯ç”±åˆ°è§„åˆ™é“¾
restEndpoint.AddRouter(endpoint.NewRouter().From("/api/v1/msg").To("chain:chain_id").End())
// å¯åŠ¨
restEndpoint.Start()
```

æ›´å¤š API ç”¨æ³•è¯·å‚è€ƒï¼š[Go API å‚è€ƒ](references/api-reference.md)

## ğŸ› ï¸ é«˜çº§ä»»åŠ¡

- **è‡ªå®šä¹‰ç»„ä»¶**ï¼šå®ç° `types.Node` æ¥å£å¹¶æ³¨å†Œã€‚å‚è€ƒï¼š[è‡ªå®šä¹‰ç»„ä»¶æŒ‡å—](references/custom-components.md)
- **åŠ¨æ€åˆ·æ–°**ï¼šä½¿ç”¨ `engine.ReloadSelf` æˆ– `engine.ReloadChild` åœ¨ä¸é‡å¯çš„æƒ…å†µä¸‹æ›´æ–°è§„åˆ™ã€‚
- **AOP æ‹¦æˆª**ï¼šåœ¨æ‰§è¡Œå‰åæ·»åŠ é’©å­æˆ–æ›¿æ¢é€»è¾‘ã€‚

## ğŸ” å‚è€ƒèµ„æ–™åº“ (å¿…å¤‡æ‰‹å†Œ)

é˜¿æ²ƒï¼Œä¸ºäº†å¸®åŠ©æ‚¨ç²¾å‡†å¼€å‘å¹¶é¿å…é‡å¤å·¥ä½œï¼Œè¯·æŸ¥é˜…ä»¥ä¸‹ç²¾ç»†åŒ–æ–‡æ¡£ï¼š

- **ğŸ“š [ç»„ä»¶å‚æ•°é‡‘å…¸ (Master Catalog)](references/component-catalog.md)**: å·²æœ‰ç»„ä»¶çš„ç²¾ç»† JSON å‚æ•°åˆ—è¡¨ã€‚**å¼€å‘ DSL å‰å¿…è¯»ã€‚**
- **âš–ï¸ [å¼€å‘å‡†åˆ™ä¸å¼€å‘è§„èŒƒ (Coding Standards)](references/development-standards.md)**: å¼€å‘æ–°æ¨¡å—ã€è§£è€¦è®¾è®¡çš„é“å¾‹ä¸é¿å‘æŒ‡å—ã€‚
- **ğŸ—ï¸ [RuleGo-Server å¼€å‘æ¨¡å¼](references/server-development.md)**: åŸºäº server é¡¹ç›®çš„ç›®å½•çº¦æŸä¸é›†æˆå·¥ä½œæµã€‚
- **ğŸ§¬ [è§„åˆ™é“¾ Schema è¯¦è§£](references/rule-chain-schema.md)**: åŸºç¡€ JSON ç»“æ„å‚è€ƒã€‚
- **ğŸ¤– [MCP Server é›†æˆ (AI ToolåŒ–)](references/mcp-server.md)**: å¦‚ä½•å°†è§„åˆ™é“¾è½¬åŒ–ä¸º AI å·¥å…·ã€‚
- **ğŸŒŠ [StreamSQL å¼€å‘æŒ‡å—](references/streamsql.md)**: å®æ—¶æµè®¡ç®—ä¸çª—å£èšåˆã€‚
- **ğŸ”ª [AOP æ‹¦æˆªå™¨æŒ‡å—](references/aop.md)**: åœ¨ç”Ÿå‘½å‘¨æœŸä¸­æ³¨å…¥ GO é€»è¾‘ã€‚
- **âš¡ï¸ [æ€§èƒ½ä¼˜åŒ–æŒ‡å—](references/performance.md)**: é«˜å¹¶å‘åŸºå‡†ä¸è°ƒä¼˜å»ºè®®ã€‚
- **ğŸ”Œ [Endpoint é›†æˆæŒ‡å—](references/endpoint.md)**: ç½‘ç»œå…¥å£é…ç½®ã€‚
- **ğŸ’» [Go API å‚è€ƒ](references/api-reference.md)**: åç«¯æ¥å£åŠè‡ªå®šä¹‰æ³¨å†Œæ–¹æ³•ã€‚
- **ğŸ› ï¸ [è‡ªå®šä¹‰ç»„ä»¶å¼€å‘](references/custom-components.md)**: Go ä»£ç å®ç°æ¨¡ç‰ˆã€‚
- **ğŸ¨ [å¯è§†åŒ–ç¼–æ’æŒ‡å—](references/visual-editor.md)**: å¦‚ä½•ä½¿ç”¨ Web ç¼–è¾‘å™¨å¿«é€Ÿç”Ÿæˆ JSONã€‚
